% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api.R
\name{facets_output_file_bundle}
\alias{facets_output_file_bundle}
\title{Build FACETS-style output-file bundle (\verb{GRAPH=} / \verb{SCORE=})}
\usage{
facets_output_file_bundle(
  fit,
  diagnostics = NULL,
  include = c("graph", "score"),
  theta_range = c(-6, 6),
  theta_points = 241,
  digits = 4,
  include_fixed = FALSE,
  fixed_max_rows = 400,
  write_files = FALSE,
  output_dir = NULL,
  file_prefix = "mfrmr_output",
  overwrite = FALSE
)
}
\arguments{
\item{fit}{Output from \code{\link[=fit_mfrm]{fit_mfrm()}}.}

\item{diagnostics}{Optional output from \code{\link[=diagnose_mfrm]{diagnose_mfrm()}} (used for score file).}

\item{include}{Output components to include: \code{"graph"} and/or \code{"score"}.}

\item{theta_range}{Theta/logit range for graph coordinates.}

\item{theta_points}{Number of points on the theta grid for graph coordinates.}

\item{digits}{Rounding digits for numeric fields.}

\item{include_fixed}{If \code{TRUE}, include fixed-width text mirrors of output tables.}

\item{fixed_max_rows}{Maximum rows shown in fixed-width text blocks.}

\item{write_files}{If \code{TRUE}, write selected outputs to files in \code{output_dir}.}

\item{output_dir}{Output directory used when \code{write_files = TRUE}.}

\item{file_prefix}{Prefix used for output file names.}

\item{overwrite}{If \code{FALSE}, existing output files are not overwritten.}
}
\value{
A named list including:
\itemize{
\item \code{graphfile} / \code{graphfile_syntactic} when \code{"graph"} is requested
\item \code{scorefile} when \code{"score"} is requested
\item \code{graphfile_fixed} / \code{scorefile_fixed} when \code{include_fixed = TRUE}
\item \code{written_files} when \code{write_files = TRUE}
\item \code{settings}: applied options
}
}
\description{
Build FACETS-style output-file bundle (\verb{GRAPH=} / \verb{SCORE=})
}
\details{
FACETS output files often include:
\itemize{
\item graph coordinates for Table 8 curves (\verb{GRAPH=} / \verb{Graphfile=}), and
\item observation-level modeled score lines (\verb{SCORE=}-style inspection).
}

This helper returns both as data frames and can optionally write
CSV/fixed-width text files to disk.

\code{summary(out)} is supported through \code{summary()}.
\code{plot(out)} is dispatched through \code{plot()} for class
\code{mfrm_output_bundle} (\code{type = "graph_expected"}, \code{"score_residuals"},
\code{"obs_probability"}).
}
\section{Interpreting output}{

\itemize{
\item \code{graphfile}: FACETS-style wide curve coordinates (human-readable labels).
\item \code{graphfile_syntactic}: same curves with syntactic column names for programmatic use.
\item \code{scorefile}: observation-level observed/expected/residual diagnostics.
\item \code{written_files}: audit trail of files produced when \code{write_files = TRUE}.
}

For reproducible pipelines, prefer \code{graphfile_syntactic} and keep
\code{written_files} in run logs.
}

\section{Typical workflow}{

\enumerate{
\item Fit and diagnose model.
\item Generate bundle with \code{include = c("graph", "score")}.
\item Validate with \code{summary(out)} / \code{plot(out)}.
\item Export with \code{write_files = TRUE} for reporting handoff.
}
}

\examples{
toy <- expand.grid(
  Person = paste0("P", 1:4),
  Rater = paste0("R", 1:2),
  Criterion = c("Content", "Organization", "Language"),
  stringsAsFactors = FALSE
)
toy$Score <- (
  as.integer(factor(toy$Person)) +
  2 * as.integer(factor(toy$Rater)) +
  as.integer(factor(toy$Criterion))
) \%\% 3
fit <- fit_mfrm(toy, "Person", c("Rater", "Criterion"), "Score", method = "JML", maxit = 25)
out <- facets_output_file_bundle(fit, diagnostics = diagnose_mfrm(fit, residual_pca = "none"))
summary(out)
p_out <- plot(out, draw = FALSE)
class(p_out)
}
\seealso{
\code{\link[=category_curves_report]{category_curves_report()}}, \code{\link[=diagnose_mfrm]{diagnose_mfrm()}}, \code{\link[=unexpected_response_table]{unexpected_response_table()}}
}
